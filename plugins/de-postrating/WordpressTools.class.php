<?php//error_reporting(E_ALL);class WordpressTools{	//*****************************************************************************************************	public $oDb;	public $oViewer;	public $oPostgre;		public $ClassPath;		// Параметри БД	public $dbLogin 				= "root";	public $dbPassword              = "";	public $dbName					= "";	public $dbHost					= "";				//*****************************************************************************************************	function __construct($aParams = null){			$this->ClassPath	= dirname(__FILE__);		$this->dbHost		= DB_HOST;		$this->dbName		= DB_NAME;		$this->dbLogin		= DB_USER;		$this->dbPassword	= DB_PASSWORD;				$this->ConnectDb();		//$this->ConnectViewer();	}		//*****************************************************************************************************	public function GetDatabaseClass(){		$bResult	= $this->ConnectDb();		if($bResult){			return $this->oDb;		}else return false;	}		//*****************************************************************************************************	public function GetDb(){		return $this->GetDatabaseClass();	}		//*****************************************************************************************************	public function GetPostgreDb($sLogin = null, $sPassword = null, $sDb = null){				if($this->oPostgre){			return $this->oPostgre;		}else{			if( !class_exists('DbSimple_Generic') ) require_once($this->ClassPath.'/includes/DbSimple/Generic.php');			$this->oPostgre	= DbSimple_Generic::connect("Postgresql://{$sLogin}:{$sPassword}@localhost/{$sDb}");			return 	$this->oPostgre;					}	}		//*****************************************************************************************************	public function ConnectViewer(){		require_once($this->ClassPath.'/includes/smarty/Smarty.class.php');		$this->oViewer	= new Smarty;	}			//*****************************************************************************************************	protected function ConnectDb(){		if(!$this->oDb){			if( !class_exists('DbSimple_Generic') ) require_once($this->ClassPath.'/includes/DbSimple/Generic.php');			$this->oDb	= DbSimple_Generic::connect("mysql://".$this->dbLogin.":".$this->dbPassword."@".$this->dbHost."/".$this->dbName."");			if($this->oDb){				$this->oDb->query('SET NAMES utf8');				return true;			}else return false;		}else return true;	}		//*****************************************************************************************************	public function GetPostUrlById($iPostId){		return get_permalink($iPostId);	}		//*****************************************************************************************************	public function GetCommentsCountByPostId($iPostId){		$aCommentsCount	= wp_count_comments($iPostId);		return $aCommentsCount->total_comments;			}		//*****************************************************************************************************	public function GetPostBySlug($sPostSlug){		$aFilter 	= array(									'name' 			=> $sPostSlug,									'post_type' 	=> 'post',									'post_status' 	=> 'publish',									'numberposts' 	=> 1							);		$aPosts = get_posts($aFilter);					if(count($aPosts) > 0){			return $aPosts[0];		}else return false;	}		//*****************************************************************************************************	public function GetWpDb(){		global $wpdb;		return $wpdb;	}		//*****************************************************************************************************	public function GetPostById($iPostId){		return get_post($iPostId);	}		//*****************************************************************************************************	public function GetUserByLogin($sLogin){		return get_user_by('login', $sLogin);	}		//*****************************************************************************************************	public function GetUserById($iUserId){		return get_user_by('id', $iUserId);	}		//*****************************************************************************************************	public function GetuserByEmail($sUserMail){		return get_user_by('email', $iUserId);	}		//*****************************************************************************************************	public function SaveUser($aUser){		return wp_insert_user($aUser);			}		//*****************************************************************************************************	public function SavePost($aPost){		return wp_insert_post($aPost);	}		//*****************************************************************************************************	public function RunQueryFromFile($sFileName){	}		//*****************************************************************************************************	public function GetAddCategoryByName($sCategory, $sSlug = null, $sTaxonomy = null){		require_once './wp-admin/includes/taxonomy.php';			if(is_null($sTaxonomy)) $sTaxonomy = 'category';		$oCategory	= get_term_by('name', $sCategory, $sTaxonomy);				if($oCategory){			return $oCategory;		}else{						$aCategory	= array(				'cat_name'				=> $sCategory,				'category_nicename'		=> $sSlug,				'taxonomy' 				=> $sTaxonomy			);						$iCatId	= wp_insert_category($aCategory);			return $this->GetAddCategoryByName($sCategory, $sSlug, $sTaxonomy);		}	}		}?>